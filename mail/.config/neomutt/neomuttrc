#
# Local configuration file for NeoMutt
#


# NOTES


# Quoting $variables
# * enclose values containing a $variable with double-quotes
# * using single-quotes does not appear to work

# <Ctrl>+key bindings
# * in binding use '\cx' for <Ctrl>+x key combination
# * can use either upper- or lowercase key in binding (case-insensitive)
# * if both <Ctrl>+x and <Ctrl>+X are present, the last binding wins
# * press either <Ctrl>+x and <Ctrl>+X to trigger binding (case-insensitive)
# * in neomutt help both <Ctrl>+x and <Ctrl>+X are shown as '^X'

# <Esc>+key bindings
# * in binding use '<Esc>x' for <Esc>+x key combination
# * case-sensitive
# * see below for interaction with <Alt>+x key combinations

# <Alt>+key bindings
# * in binding use '\ex' for <Alt>+x key combination
# * case-sensitive
# * is displayed in neomutt help as '<Esc>x'
# * <Alt>+key is a synonym for <Esc>+key
# * both key combinations can be used to trigger the bound function
# * if both <Alt> and <Esc> bindings for the same key are present,
#   the last binding wins


# TODO


# vim syntax for markdown in email
# * consider "inkarkat/vim-SyntaxRange" github repo
#   (https://github.com/inkarkat/vim-SyntaxRange)
# * requires plugin "inkarkat/vim-ingo-library"
# * start of region is first blank line, for which the regex is: \n\n
# * end of region is end of file, for which the regex is: \%$

# periodically create alias file from notmuch
# * for use with $query_command

# consider using Konfekt/mutt-trim
# * https://github.com/Konfekt/mutt-trim

# create script man files


# LOAD/RELOAD CONFIGURATION


# clear settings (make script idempotent)
#source neomuttrc.d/clear-settings.rc

# [gibp] <Ctrl>+r : reload configuration
macro generic,index,browser,pager \cr "\
<enter-command>unhook *<enter>\
<enter-command>source $my_config<enter>\
<enter-command>echo 'Reloaded $my_config'<enter>\
"    'clear hooks and reload configuration'


# CUSTOM VARIABLES


set my_name = 'David Nebauer'
set my_email = 'david@nebauer.id.au'
set my_maildir = $HOME/.local/mail/maildirs
set my_account = personal
set my_mailbox = $my_maildir/$my_account
set my_cfgdir = $HOME/.config/neomutt
set my_cfgdir_d = $my_cfgdir/neomuttrc.d
set my_config = $my_cfgdir/neomuttrc
set my_mailcap = $my_cfgdir/mailcap
set my_utils = $HOME/.local/mail/utils
set my_nvim_args = $my_utils/neomutt_nvim-args.vim
set my_print_pdf = $my_utils/neomutt_print-to-pdf
set my_signature = $my_cfgdir_d/signature
set my_download_dir = $HOME/Downloads
set my_cache = $HOME/.cache/neomutt
set my_header_cache = $my_cache/cache-headers
set my_message_cache = $my_cache/cache-messages
set my_poll_script = $HOME/.local/bin/my-get-mail
set my_msmtpq = $HOME/.local/bin/msmtpq


# MANAGE MAILBOXES


# Standard mailboxes

set mbox_type = Maildir
    # default mailbox type
set folder = $my_mailbox
    # default location of mailboxes
set record = +INBOX.Sent
    # sent folder
set trash = +INBOX.Trash
    # trash folder
set postponed = +INBOX.Drafts
    # drafts folder
set spool_file = +INBOX
    # inbox folder

# Virtual mailboxes

set nm_default_url = 'notmuch:///home/david/.local/mail/maildirs'
    # cannot use 'folder', must use 'nm_default_url'
set vfolder_format = '%6n(%6N) %f'
    # file browser display format for vfolders
set maildir_check_cur
    # poll maildir 'cur' directory as well as 'new' directory
set nm_query_type = threads
    # default query type {threads,messages}
set nm_record
    # add sent messages to notmuch database
set nm_record_tags = "-inbox,+archive,+sent"
    # adjust tags of sent messages added to notmuch database
set sort = date
    # index menu sort value
    # {date,date-received,from,score,size,spam,subject,threads,to,unsorted}
set sort_aux = last-date-received
    # index menu secondary sort value
set spool_file = 'Inbox'
    # if not set Inbox defaults to '/var/mail/david' as per <mail> function
    # if set then setting 'virtual_spool_file' to either {yes,no} has no effect
unmailboxes *
unvirtual-mailboxes *
virtual-mailboxes \
  'Inbox'   "notmuch://?query=folder:$my_account/INBOX" \
  'Archive' "notmuch://?query=folder:$my_account/INBOX.Archive" \
  'Sent'    "notmuch://?query=folder:$my_account/INBOX.Sent" \
  'Drafts'  "notmuch://?query=folder:$my_account/INBOX.Drafts" \
  'Spam'    "notmuch://?query=folder:$my_account/INBOX.Spam" \
  'Junk'    "notmuch://?query=folder:$my_account/INBOX.Junk" \
  'Trash'   "notmuch://?query=folder:$my_account/INBOX.Trash"

# Hooks

folder-hook '.' \
    "source $my_utils/neomutt_folder-hook_all"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX" \
    "source $my_utils/neomutt_folder-hook_inbox"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX.Archive" \
    "source $my_utils/neomutt_folder-hook_archive"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX.Sent" \
    "source $my_utils/neomutt_folder-hook_sent"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX.Drafts" \
    "source $my_utils/neomutt_folder-hook_drafts"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX.Spam" \
    "source $my_utils/neomutt_folder-hook_spam"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX.Junk" \
    "source $my_utils/neomutt_folder-hook_junk"
folder-hook -noregex "notmuch://?query=folder:$my_account/INBOX.Trash" \
    "source $my_utils/neomutt_folder-hook_trash"

# Sidebar

set sidebar_visible
set mail_check_stats
set sidebar_format = '%D%?F? [%F]?%* %?N?%N/?%S'
set mail_check_stats
set sort_browser = unsorted
# [ip] <Right> : next sidebar vfolder
bind index,pager <Right> sidebar-next
# [ip] <Left> : previous sidebar vfolder
bind index,pager <Left> sidebar-prev
# [ip] <Ctrl>+o : open sidebar vfolder
bind index,pager \co sidebar-open

# Change mailbox

bind index,pager ca noop
bind index,pager cd noop
bind index,pager cf noop
bind index,pager ci noop
bind index,pager cj noop
bind index,pager cm noop
bind index,pager cs noop
bind index,pager ct noop
bind index,pager c noop
# [ip] ci : change to Inbox vfolder
macro index,pager ci '<change-vfolder>Inbox<enter>'   'open Inbox'
# [ip] ca : change to Archive vfolder
macro index,pager ca '<change-vfolder>Archive<enter>' 'open Archive'
# [ip] cs : change to Sent vfolder
macro index,pager cs '<change-vfolder>Sent<enter>'    'open Sent'
# [ip] cd : change to Draft vfolder
macro index,pager cd '<change-vfolder>Drafts<enter>'  'open Drafts'
# [ip] cm : change to Spam vfolder
macro index,pager cm '<change-vfolder>Spam<enter>'    'open Spam'
# [ip] cj : change to Junk vfolder
macro index,pager cj '<change-vfolder>Junk<enter>'    'open Junk'
# [ip] ct : change to Trash vfolder
macro index,pager ct '<change-vfolder>Trash<enter>'   'open Trash'
# [ip] cf : select vfolder to change to
macro index,pager cf '<change-vfolder>?'              'open mailbox...'

# Synchronise

timeout-hook 'exec sync-mailbox'
startup-hook 'exec sync-mailbox'
shutdown-hook 'exec sync-mailbox'


# MESSAGE MANAGEMENT


# Display

# [i] <return> : display message
bind index <Return> display-message

# Search for messages

# [ip] s : search current vfolder
# - set in folder-hooks
# [ip] X : custom search creating temporary vfolder
bind index,pager X vfolder-from-query

# Threads

# [ip] + : read thread of current message
bind index,pager + entire-thread
# [i] za : toggle collapse of current thread
bind index za collapse-thread
# [i] zA : toggle collapse of all threads
# - missing :folddisable/foldenable
bind index zA collapse-all

# Tagging

# [i] <insert> : tag current message
macro index <Insert> "\
<enter-command>push t<enter>\
"    'select/tag current message'
# [i] <Ctrl>+a : tag all messages
macro index \ca "\
<tag-pattern>~A<enter>\
"    'select/tag all messages'
# [i] <Ctrl>+u : untag all messages
macro index \cu "\
<untag-pattern>~A<enter>\
"    'unselect/untag all messages'

# Tags (neomutt)

# [i] W : clear
macro index W "\
<tag-prefix><clear-flag>\
"    'clear a status flag from messages(s)'

# Labels (notmuch)

bind index,pager yd noop
bind index,pager yf noop
bind index,pager yl noop
bind index,pager yo noop
bind index,pager yp noop
bind index,pager yu noop
bind index,pager yv noop
bind index,pager yy noop
bind index,pager y noop
# [ip] yy : manually modify
macro index yy "\
<tag-prefix><modify-labels>\
"    'modify (notmuch/imap) tags'
bind pager yy modify-labels
# [ip] yd : add [development] label
macro index yd "\
<enter-command>echo \
'Adding [development] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+development<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: development'
macro pager yd "\
<enter-command>echo 'Adding [development] label...'<enter>\
<modify-labels>+development<enter>\
"    'add label: development'
# [ip] yf : add [financial] label
macro index yf "\
<enter-command>echo 'Adding [financial] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+financial<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: financial'
macro pager yf "\
<enter-command>echo 'Adding [financial] label...'<enter>\
<modify-labels>+financial<enter>\
"    'add label: financial'
# [ip] yl : add [later] label
macro index yl "\
<enter-command>echo 'Adding [later] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+later<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: later'
macro pager yl "\
<enter-command>echo 'Adding [later] label...'<enter>\
<modify-labels>+later<enter>\
"    'add label: later'
# [ip] yo : add [order] label
macro index yo "\
<enter-command>echo 'Adding [order] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+order<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: order'
macro pager yo "\
<enter-command>echo 'Adding [order] label...'<enter>\
<modify-labels>+order<enter>\
"    'add label: order'
# [ip] yp : add [personal] label
macro index yp "\
<enter-command>echo 'Adding [personal] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+personal<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: personal'
macro pager yp "\
<enter-command>echo 'Adding [personal] label...'<enter>\
<modify-labels>+personal<enter>\
"    'add label: personal'
# [ip] yu : add [union] label
macro index yu "\
<enter-command>echo 'Adding [union] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+union<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: union'
macro pager yu "\
<enter-command>echo 'Adding [union] label...'<enter>\
<modify-labels>+union<enter>\
"    'add label: union'
# [ip] yv : add [vault] label
macro index yv "\
<enter-command>echo 'Adding [vault] label...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><modify-labels>+vault<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
"    'add label: vault'
macro pager yv "\
<enter-command>echo 'Adding [vault] label...'<enter>\
<modify-labels>+vault<enter>\
"    'add label: vault'

# Move

unset confirm_append  # no confirm needed when append to mailbox
# [ip] a : archive message
macro index a "\
<enter-command>echo 'Archiving...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><clear-flag>N\
<tag-prefix><modify-labels>\
-inbox +archive -draft -spam -trash -sent -unread -new -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<tag-prefix><save-message>+INBOX.Archive<enter>\
<sync-mailbox>\
"    'move to Archive'
macro pager a "\
<enter-command>echo 'Archiving...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<clear-flag>N\
<modify-labels>\
-inbox +archive -draft -spam -trash -sent -unread -new -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<save-message>+INBOX.Archive<enter>\
<sync-mailbox>\
"    'move to Archive'
# move to other mailboxes
bind index,pager MD noop
bind index,pager MI noop
bind index,pager MJ noop
bind index,pager MM noop
bind index,pager MS noop
bind index M noop
# [ip] MI : move to Inbox
macro index MI "\
<enter-command>echo 'Moving to Inbox...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><clear-flag>N\
<tag-prefix><modify-labels>\
+inbox -archive -draft -spam -trash -sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<tag-prefix><save-message>+INBOX<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move mail to Inbox'
macro pager MI "\
<enter-command>echo 'Moving to Inbox...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<clear-flag>N\
<modify-labels>\
+inbox -archive -draft -spam -trash -sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<save-message>+INBOX<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move to Inbox'
# [ip] MD : move to Drafts
macro index MD "\
<enter-command>echo 'Moving to Drafts...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><clear-flag>N\
<tag-prefix><modify-labels>\
-inbox -archive +draft -spam -trash -sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<tag-prefix><save-message>+INBOX.Drafts<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move mail to Drafts'
macro pager MD "\
<enter-command>echo 'Moving to Drafts...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<clear-flag>N\
<modify-labels>\
-inbox -archive +draft -spam -trash -sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<save-message>+INBOX.Drafts<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move to Drafts'
# [ip] MJ : move to Spam
macro index MJ "\
<enter-command>echo 'Moving to Spam...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><clear-flag>N\
<tag-prefix><modify-labels>\
-inbox -archive -draft +spam -trash -sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<tag-prefix><save-message>+INBOX.Spam<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move mail to Spam'
macro pager MJ "\
<enter-command>echo 'Moving to Spam...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<clear-flag>N\
<modify-labels>\
-inbox -archive -draft +spam -trash -sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<save-message>+INBOX.Spam<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move to Spam'
# [ip] MS : move to Sent
macro index MS "\
<enter-command>echo 'Moving to Sent...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<tag-prefix><clear-flag>N\
<tag-prefix><modify-labels>\
-inbox -archive -draft -spam -trash +sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<tag-prefix><save-message>+INBOX.Sent<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move mail to Sent'
macro pager MS "\
<enter-command>echo 'Moving to Sent...'<enter>\
<enter-command>set my_resolve=\$resolve<enter>\
<enter-command>unset resolve<enter>\
<clear-flag>N\
<modify-labels>\
-inbox -archive -draft -spam -trash +sent -unread -junk<enter>\
<enter-command>set resolve=\$my_resolve<enter>\
<enter-command>unset my_resolve<enter>\
<save-message>+INBOX.Sent<enter>\
<sync-mailbox>\
<change-vfolder>^<enter>\
"    'move to Sent'

# Delete

set delete = yes
    # purge deleted messages on mailbox close/syncronisation
# [ip] d,<delete> : trash messages
# - set in folder-hooks
# - trashes messages in all vfolders except Trash
# - deletes messages in Trash vfolder
# [ip] u : untrash message
# - in Trash folder only


# FETCH

# [i] P : fetch mail
macro index P "\
<shell-escape>$my_poll_script<enter>\
<change-vfolder>Inbox<enter>\
"    'run offlineimap to fetch mail'


# VIEW


set move
    # move read messages from $spool_file to $mbox
set mbox = +INBOX.Archive
    # folder into which read mail is appended
set attach_save_dir = $my_download_dir
    # default 'download' directory
set print_command = $my_print_pdf
    # conversion to pdf
unset print_decode
    # do not decode message before printing
set print = ask-yes
    # check in case accidentally pressed 'p'
unset mark_old
    # no 'old' tag, 'new' is good enough
set header_cache = $my_header_cache
set message_cachedir = $my_message_cache
    # try to speed up by caching
set pager_context = 3
    # lines of overlap when PgUp and PgDown
set tilde
    # pad blank lines with tildes
set pager_stop
    # do not automatically PgDown
unset prompt_after
    # no prompt when external pager exits

# prefer html
unauto_view *
auto_view text/html \
          application/postscript \
          application/x-gunzip \
          application/x-tar-gz \
          application/octet-stream
unalternative_order *
alternative_order text/html \
                  text/plain \
                  text
# [ip] V : open message in default html viewer
bind index,pager V noop
macro index,pager V "\
<view-attachments>\
<search>html<enter>\
<view-mailcap>\
<exit>\
"    'open message in default browser'

# [ipac] <Ctrl>+b : view/copy urls
macro index,pager \cb "\
<pipe-message>urlscan<enter>\
"    'call urlscan to extract URLs out of a message'
macro attach,compose \cb "\
<pipe-entry> urlscan<enter>\
"    'call urlscan to extract URLs out of a message'

# [ip] S : save all attachments
macro index,pager S "\
<pipe-message>\
ripmime -i - -d $my_download_dir && rm $my_download_dir/textfile*<enter>\
<enter-command>echo 'Attachments saved to $my_download_dir'<enter>\
"    'Save all non-text attachments using ripmime'


# COMPOSE


set real_name = $my_name
    # sender's real name
alias me $my_name <$my_email>
    # alias for sender
set from = $my_email
    # default 'from' address
set edit_headers
    # show headers when composing
ignore *
unignore From: To: CC: BCC: Subject:
    # warning: [un]ignore setting is not honoured
unhdr_order *
hdr_order From: Subject: To: Cc: Bcc:
    # warning: hdr_order setting is not honoured
set use_from
    # include 'From:' header in sent message
set user_agent
    # include 'User-Agent:' header in sent message
set query_command = "echo '' && notmuch address from:/%s/"
    # used by <complete-query> function,
    # first line of results is presumed to be header so it is auto-trimmed
    # but notmuch does not include a header line
    # so the 'echo' command is a workaround for this
set editor = "nvim -S '$my_nvim_args' +/^$/+1 '+startinsert!'"
    # editor invocation, uses external file for initial arguments
set text_flowed
    # generate content type 'text/plain; format-flowed'
set query_format="%4c %t %-70.70a %-70.70n %?e?(%e)?"
    # format of 'query' menu
set signature = $my_signature
    # signature file
unset sig_dashes
    # no dashes before sig
set attribution="* %n <%a> [%{%Y-%m-%d %H:%M:%S %Z}]:\n"
    # string preceding message included in reply
set mime_forward = ask-no
    # asks whether to forward message as mime attachment rather than inline
set fast_reply
    # skip initial prompts when replying, jump straight to editor
set forward_format = 'Fwd: %s'
    # format of subject when forwarding
set reply_to
    # reply to address in 'Reply-To:' field rather than 'From:' field
set include
    # include message in replies
set forward_quote
    # include message in forwards
set ispell = 'aspell -e -c'
    # 'ispell' invocation

# [e] <Tab> : complete email address (using $query_command)
bind editor <Tab> complete-query
# [e] <Ctrl>+t : complete filename or alias
bind editor \ct complete


# SEND


set sendmail = "$my_msmtpq"
    # email sending program
set sendmail_wait = -1
    # send in background, 0 waits forever to finish
set abort_noattach = ask-yes
    # check before sending if suspect attachments are missing

# [c] Y : convert markdown to html and send
# - macro solution from NeoMutt Guide (https://neomutt.org/guide),
#   Chapter 5.2 'Composing Multipart Alternative Emails'
macro compose Y "\
<first-entry>\
<enter-command>set my_wait_key=\$wait_key<enter>\
<enter-command>unset wait_key<enter>\
<pipe-entry>pandoc -o $my_cache/text-alternative.html<enter>\
<attach-file>$my_cache/text-alternative.html<enter>\
<toggle-unlink><toggle-disposition>\
<tag-entry><first-entry><tag-entry><group-alternatives>\
<enter-command>set wait_key=\$my_wait_key<enter>\
<enter-command>unset my_wait_key<enter>\
<send-message>\
"    "send the message as 'multipart/alternative'"


# INTERFACE


# [ip] MM : show log messages
bind index,pager MM show-log-messages

set pager_index_lines = 8
    # show mini-index
    # warning: neither pager- nor index-bound macros work in mini-pager
set quit = ask-yes
    # don't quit accidentally
set timeout = 0
    # wait indefinitely for user input
unset wait_key
    # minimise 'Press any key to continue...' messages
set index_format = '%4C %Z %?X?%X📎&   ? \
%<[365d?%<[7d?%<[1d?%[%R]&%[%a-%d]>&%[%b-%d]>&%[%F]> \
%-20.20L (%?l?%4l&%4c?) [%g] %s'
    # format of index lines
    # - email date-time is defined by '%<[365d .. [%F]>' sequence
    #   * is a conditional date sequence
    #     (see https://neomutt.org/feature/cond-date)
    #   * test      date range       format string   example
    #     -----------------------------------------------------
    #     %[1d      today            %[%R]           12:34
    #     %[7d      last 7 days      %[%a-%d]        Thu-12
    #     %[365d    last 365 days    %[%b-%d]        Dec-10
    #     ―         older            %[%F]           2015-06-27
    # - number of MIME attachments is defined by '%X? .. & .. ?' sequence
    #   * is a conditional construct
    #   * '%X?%X📎&   ?' breaks down as:
    #      %X?           # if number is non-zero
    #         %X📎       # then display number followed by paperclip character
    #                    #   (U+1F4CE, which shows here as '📎')
    #             &   ?  # else display 3 spaces, which is equivalent to:
    #                    #   1 digit + U+1F4CE
    #                    #   (which is as wide as 2 characters)
source $my_cfgdir_d/colours.rc
    # colour scheme

push <show-version>
    # display version on startup


# vim: ft=neomuttrc fdm=marker
